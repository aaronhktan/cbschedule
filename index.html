<!DOCTYPE html>
 <html>
 	<head>
 		<meta charset="utf-8">
 		<meta name="description" content="Change your settings for the CB Schedule pebble app."/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
 		<title>CB Schedule Manager</title>
 		<link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHZpZXdCb3g9IjAgMCA4IDgiPgogIDxwYXRoIGQ9Ik01LjUgMGMtMS4zOCAwLTIuNSAxLjEyLTIuNSAyLjUgMCAuMTYgMCAuMzIuMDMuNDdsLTMuMDMgMy4wM3YyaDN2LTJoMnYtMWwuMDMtLjAzYy4xNS4wMy4zMS4wMy40Ny4wMyAxLjM4IDAgMi41LTEuMTIgMi41LTIuNXMtMS4xMi0yLjUtMi41LTIuNXptLjUgMWMuNTUgMCAxIC40NSAxIDFzLS40NSAxLTEgMS0xLS40NS0xLTEgLjQ1LTEgMS0xeiIgLz4KPC9zdmc+"/>
 		<link href='https://fonts.googleapis.com/css?family=Roboto:300,700,400' rel='stylesheet' type='text/css'>
 		<link href="css/main.css" rel="stylesheet" type="text/css"/>
 	</head>
 	<body>
 		<div id="title">
 			<p>CB Schedule Manager</p>
 		</div>
 		<div class="input-title" id="inputs_0">
 			<strong>Period 1A </strong>
				<br>Course:<br>
					<input id="period-1a-input" type="text" onblur="this.value=removeSpaces(this.value)"/>
				<br>Course Code:<br>
					<input id="period-1a-code-input" type="text" onblur="this.value=removeSpaces(this.value)"/>
			<br><br> <strong>Period 1B </strong>
				<br>Course:<br>
					<input id="period-1b-input" type="text" onblur="this.value=removeSpaces(this.value);"/>
				<br>Course Code:<br>
					<input id="period-1b-code-input" type="text" onblur="this.value=removeSpaces(this.value)"/>
			<br><br> <strong>Period 1C </strong>
				<br>Course:<br>
					<input id="period-1c-input" type="text" onblur="this.value=removeSpaces(this.value);"/>
				<br>Course Code:<br>
					<input id="period-1c-code-input" type="text" onblur="this.value=removeSpaces(this.value)"/>
			<br><br> <strong>Period 1D </strong>
				<br>Course:<br>
					<input id="period-1d-input" type="text" onblur="this.value=removeSpaces(this.value);"/>
				<br>Course Code:<br>
					<input id="period-1d-code-input" type="text" onblur="this.value=removeSpaces(this.value)"/>
			<br><br> <strong>Period 2A </strong>
				<br>Course:<br>
					<input id="period-2a-input" type="text" onblur="this.value=removeSpaces(this.value);"/>
				<br>Course Code:<br>
					<input id="period-2a-code-input" type="text" onblur="this.value=removeSpaces(this.value)"/>
			<br><br> <strong>Period 2B: </strong>
				<br>Course:<br>
					<input id="period-2b-input" type="text" onblur="this.value=removeSpaces(this.value);"/>
				<br>Course Code:<br>
					<input id="period-2b-code-input" type="text" onblur="this.value=removeSpaces(this.value)"/>
			<br><br> <strong>Period 2C: </strong>
				<br>Course:<br>
					<input id="period-2c-input" type="text" onblur="this.value=removeSpaces(this.value);"/>
				<br>Course Code:<br>
					<input id="period-2c-code-input" type="text" onblur="this.value=removeSpaces(this.value)"/>
			<br><br> <strong>Period 2D: </strong>
				<br>Course: <br>
					<input id="period-2d-input" type="text" onblur="this.value=removeSpaces(this.value);"/>
				<br>Course Code:<br>
					<input id="period-2d-code-input" type="text" onblur="this.value=removeSpaces(this.value)"/>
			<br><br>
		</div>
		<div id="addbutton">
			<button id="add_button" class="button" onClick=addInput("inputs_0")>Add another schedule</button>
		</div>
 		<div id="savebutton">
			<button id="submit_button" class="button">Save</button>
 		</div>
 		<script type="text/javascript">
 		  	// Get a handle to the button's HTML element
 		  	var submitButton = document.getElementById('submit_button');
 		
 		  	// Add a 'click' listener
 		  	submitButton.addEventListener('click', function() {
 		    	
 		    	// Get the config data from the UI elements
	 		    var input = document.getElementsByTagName('input');
	 		    var periods = [];
	 		    for (i = 0; i < input.length; i++) {
	 		    	periods[i] = input[i].value;
	 		    }
				
	 		    // Make a data object to be sent
	 		    var options = {
	 		    	'onea': periods[0],
	 		    	'oneb': periods[2],
	 		    	'onec': periods[4],
	 		    	'oned': periods[6],
	 		    	'twoa': periods[8],
	 		    	'twob': periods[10],
	 		    	'twoc': periods[12],
	 		    	'twod': periods[14],
					'oneacode': periods[1],
					'onebcode': periods[3],
					'oneccode': periods[5],
					'onedcode': periods[7],
					'twoacode': periods[9],
					'twobcode': periods[11],
					'twoccode': periods[13],
					'twodcode': periods[15],
	 		    };

	 		    alert(JSON.stringify(options));
 		
	 		    // Determine the correct return URL (emulator vs real watch)
	 		    function getQueryParam(variable, defaultValue) {
	 		      var query = location.search.substring(1);
	 		      var vars = query.split('&');
	 		      for (var i = 0; i < vars.length; i++) {
	 		        var pair = vars[i].split('=');
	 		        if (pair[0] === variable) {
	 		          return decodeURIComponent(pair[1]);
	 		        }
	 		      }
	 		      return defaultValue || false;
	 		    }
	 		    var return_to = getQueryParam('return_to', 'pebblejs://close#');
	 		
	 		    // Encode and send the data when the page closes
	 		    document.location = return_to + encodeURIComponent(JSON.stringify(options));
 		  })
 		</script>
 		<script type="text/javascript">
			function removeSpaces(string) {
	 			s = string;
				s = s.replace(/(^\s*)|(\s*$)/gi,"");
				s = s.replace(/[ ]{2,}/gi," ");
				s = s.replace(/\n /,"\n");
				return s
			}
		</script>
		<script type="text/javascript">
			var input = document.getElementsByTagName('input'); 	//Creates an array with all the inputs on the page
			for (i = 0; i < input.length; i++) { 					//Cycles through elements in that array
				url = window.location.search.substring(i); 			//Searches the URL for the element number
				if (url.search(i) != -1) { 							//If the URL has a number
					params = url.split("&"); 						//Creates an array with each element being separated by "&"
					for (x = 0; x < params.length; x++) { 			//Checks each element
						param = params[x].split("="); 				//Splits up each parameter in URL by "="
					        if (param[0] == i.toString()) { 		//If the first part of the paramater is equal to the element number
					        	input[i].value = param[1];			//The element's value is set to the second part of the parameter.
					        }
					}
				}
				else {
					input[i].value = "";
				}
			}
		</script>
		<script>
			var counter = 0;
			function addInput(divName) {
				counter += 1;

				//Create div for title
				var newdiv = document.createElement('div');
				newdiv.setAttribute("id", "title");
				newdiv.setAttribute('class', 'title');
				newdiv.innerHTML = "<br><br><strong>Friend #1</strong><br><br>";

				//Create div for text input
				var newdiv2 = document.createElement('div');
				newdiv2.setAttribute('id', 'inputs_' + counter);
				newdiv2.innerHTML = "<strong>Name<strong><br><input type='text'><br><br>Period 1A:<br><br>";

				
				document.getElementById(divName).appendChild(newdiv);
				document.getElementById(divName).appendChild(newdiv2);
			}
		</script>
 	</body>
 </html>