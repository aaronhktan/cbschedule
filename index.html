<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="description" content="Change your settings for the CB Schedule pebble app.">
		<title>CB Schedule Manager</title>
		<link rel="icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHZpZXdCb3g9IjAgMCA4IDgiPgogIDxwYXRoIGQ9Ik01LjUgMGMtMS4zOCAwLTIuNSAxLjEyLTIuNSAyLjUgMCAuMTYgMCAuMzIuMDMuNDdsLTMuMDMgMy4wM3YyaDN2LTJoMnYtMWwuMDMtLjAzYy4xNS4wMy4zMS4wMy40Ny4wMyAxLjM4IDAgMi41LTEuMTIgMi41LTIuNXMtMS4xMi0yLjUtMi41LTIuNXptLjUgMWMuNTUgMCAxIC40NSAxIDFzLS40NSAxLTEgMS0xLS40NS0xLTEgLjQ1LTEgMS0xeiIgLz4KPC9zdmc+"/>
		<link href='https://fonts.googleapis.com/css?family=Roboto:300,700,400' rel='stylesheet' type='text/css'/>
		<link href="css/main.css" rel="stylesheet"/>
		<script>
			function trimSpaces(value){
				s = value;
				s = s.replace(/(^\s*)|(\s*$)/gi,"");
				s = s.replace(/[ ]{2,}/gi," ");
				s = s.replace(/\n /,"\n");
				return s
			};
			
			function queryPeriods(paramName) {
			    url = window.location.search.substring(1);
			    params = url.split("&");
			
			    for (i=0; i<params.length; i++) {
			        param = params[i].split("=");
			        if (param[0] == paramName) {
			        	return param[1];
			        }
		        	else if (window.location.search.substring(1).prototype.indexOf(paramName) == -1) {
		        		return "";
		        	}
			    }
			};
		</script>
	</head>
	<body>
		<div id="title">
			<p>CB Schedule Manager</p>
		</div>
		<div class="input-title">
			<strong>Period 1A</strong>
			<input id="period-onea-input" type="text" onblur="this.value=trimSpaces(this.value)"/>
		</div>
		<div class="input-title">
			<strong>Period 1B</strong>
			<input id="period-oneb-input" type="text" onblur="this.value=trimSpaces(this.value)"/>
		</div>
		<div class="input-title">
			<strong>Period 1C</strong>
			<input id="period-onec-input" type="text" onblur="this.value=removeSpaces(this.value)"/>
		</div>
		<div class="input-title">
			<strong>Period 1D</strong>
			<input id="period-oned-input" type="text" onblur="this.value=trimSpaces(this.value)"/>
		</div>
		<div class="input-title">
			<strong>Period 2A</strong>
			<input id="period-onea-input" type="text" onblur="this.value=trimSpaces(this.value)"/>
		</div>
		<div class="input-title">
			<strong>Period 2B</strong>
			<input id="period-oneb-input" type="text" onblur="this.value=trimSpaces(this.value)"/>
		</div>
		<div class="input-title">
			<strong>Period 2C</strong>
			<input id="period-onec-input" type="text" onblur="this.value=trimSpaces(this.value)"/>
		</div>
		<div class="input-title">
			<strong>Period 2D</strong>
			<input id="period-oned-input" type="text" onblur="this.value=trimSpaces(this.value)"/>
		</div>
		<div id="savebutton">
			<input id="submit_button" type="button" value="Save"/>
		</div>
		<script>
		  // Get a handle to the button's HTML element
		  var submitButton = document.getElementById('submit_button');
		
		  // Add a 'click' listener
		  submitButton.addEventListener('click', function() {
		    // Get the config data from the UI elements
		    var onea = document.getElementById('period-onea-input').value;
		    var oneb = document.getElementById('period-oneb-input').value;
		    var onec = document.getElementById('period-onec-input').value;
		    var oned = document.getElementById('period-oned-input').value;
		    var twoa = document.getElementById('period-twoa-input').value;
		    var twob = document.getElementById('period-twob-input').value;
		    var twoc = document.getElementById('period-twoc-input').value;
		    var twod = document.getElementById('period-twod-input').value;
		
		    // Make a data object to be sent, coercing value types to integers
		    var options = {
		      'onea': onea,
		      'oneb': oneb,
		      'onec': onec,
		      'oned': oned,
		      'twoa': twoa,
		      'twob': twob,
		      'twoc': twoc,
		      'twod': twod
		    };
		
		    // Determine the correct return URL (emulator vs real watch)
		    function getQueryParam(variable, defaultValue) {
		      var query = location.search.substring(1);
		      var vars = query.split('&');
		      for (var i = 0; i < vars.length; i++) {
		        var pair = vars[i].split('=');
		        if (pair[0] === variable) {
		          return decodeURIComponent(pair[1]);
		        }
		      }
		      return defaultValue || false;
		    }
		    var return_to = getQueryParam('return_to', 'pebblejs://close#');
		
		    // Encode and send the data when the page closes
		    document.location = return_to + encodeURIComponent(JSON.stringify(options));
		  });
		var oneainput = queryPeriods("onea");
		alert(hello);
		var onebinput = queryPeriods("oneb");
		alert(hello);
		var onecinput = queryPeriods("onec");
		var onedinput = queryPeriods("oned");
		var twoainput = queryPeriods("twoa");
		var twobinput = queryPeriods("twob");
		var twocinput = queryPeriods("twoc");
		var twodinput = queryPeriods("twod");
		document.getElementByID('period-onea-input').value=hello;
		document.getElementByID('period-oneb-input').value=onebinput;
		document.getElementByID('period-onec-input').value=onecinput;
		document.getElementByID('period-oned-input').value=onedinput;
		document.getElementByID('period-twoa-input').value=twoainput;
		document.getElementByID('period-twob-input').value=twobinput;
		document.getElementByID('period-twoc-input').value=twocinput;
		document.getElementByID('period-twod-input').value=twodinput;
		</script>
	</body>
</html>
